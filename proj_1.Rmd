---
title: 'Project 1: A Simulation Study to Compare Three Survival Models'
author: 'Group 2, UNI: jr3755, cz2544, xw2598'
date: "February 6, 2019"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(coxed)
library(survival)
library(quantreg)
library(glmnet)
library(MASS)
library(pROC)
set.seed(8160201902)
```

from syllabus: 

Each report should include (1) A description of the statistical problem to be addressed; (2) A general description of the approach taken, along with some justication for the direction taken;(3) Conclusions, along with supporting output (typically including graphics); (4) The complete code.

project requirement:

Your tasks: Design a simulation study to evaluate the impacts of misspecifying the baseline hazard function
on the estimate of the treatment effect, and one could avoid this issue by using a semi-parametric Cox model.
In the meantime, investigate the impact of fitting too complicated a model when an exponential is sufficient

published studies:
The simulation study would include data simulated under various distributions such as exponential, Weibull, log-normal, log-logistic and with different sample sizes and effect sizes, to evaluate power, type I error rate and precision of the estimated coefficient.


========================
Start here:


**1. Objectives:**
1.1 Design a simulation study to evaluate the impacts of misspecifying the baseline hazard function
on the estimate of the treatment effect, and one could avoid this issue by using a semi-parametric Cox model.

\begin{table}[ht]
\caption{impacts of misspecifying the baseline hazard function}
\begin{center}
\begin{tabular}{|l|c|}
\hline
baseline hazard function & fit model & estimator \\[1mm]\hline

\text  exponential proportional-hazards baseline & exponential proportional-hazards model\\[2mm]
\text     &Weibull proportional-hazards model \\[2mm]
\text     &Cox proportional-hazards model\\[2mm]
\text  Weibull proportional-hazards baseline  & exponential proportional-hazards model\\[2mm]
\text     & Weibull proportional-hazards model\\[2mm]
\textbf   & Cox proportional-hazards model \\
\hline
\end{tabular}
\end{center}
\label{default}
\end{table}

1.2 Investigate the impact of fitting too complicated a model when an exponential is sufficient
begin{table}[ht]
\caption{impact of fitting a too complicated model}
\begin{center}
\begin{tabular}{|l|c|}
\hline
baseline hazard function & fit model & estimator & power & bias \\[1mm]\hline

\text  exponential proportional-hazards baseline & exponential proportional-hazards model &  & \\[2mm]
\text     &Weibull proportional-hazards model &  & \\[2mm]
\text     &Cox proportional-hazards model &  & \\[2mm]
\text  Weibull proportional-hazards baseline  & exponential proportional-hazards model &  & \\[2mm]
\text     & Weibull proportional-hazards model &   & \\[2mm]
\textbf   & Cox proportional-hazards model &   & \\
\hline
\end{tabular}
\end{center}
\label{default}
\end{table}

**2. Statistical methods to be studied:**( Methods for generating the datasets)
3 Proportional hazards models: An exponential proportional-hazards model,A Weibull proportional-hazards model, A Cox proportional-hazards model.


**3. Scenarios to be investigated:**

**4. Methods for generating data:**

**5. Performance measures:**

**6. Simulation results:**

**7. Conclusions:**

**8. Discussions:**

#step 1. generate data
1.1 derivation of the t fomular (Ren):

n
miu
randome error

1) decay rate miu = 1
2) decay rate miu = 2
3) decay rate miu = 0.5

1.2 plot to confirm good randomnes

plot1
plot2
plot2

#step 2. fit different data into different model and get estimation points

1) Exponential
2) Weibull
3) Cox

test goodness of fit for different model,

estimation perfomance: invaraince(sample size), accuracy(bias vs variance)
plots/table:

AIC
CI and p-Value

same simulation dataset in different models survplots,

Effect of frailty

### R codes for Hazard Ratio Estimation
```{r, eval=F, echo=T}
# Exponential
fit.exponential <- survreg(Surv(y) ~ x[, 1] + x[, 2], dist = "exponential")
summary(fit.exponential)
- fit.exponential$coefficients[-1]

# Weibull
fit.weibull <- survreg(Surv(y) ~ x[, 1] + x[, 2], dist = "weibull")
summary(fit.weibull)
- fit.weibull$coefficients[-1] / fit.weibull$scale

# Cox
fit.cox <- coxph(Surv(y) ~ x[, 1] + x[, 2])
summary(fit.cox)
```


